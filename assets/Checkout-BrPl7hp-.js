import{c as T,B as A,H as O,D as G,j as m,G as N,q as e,L as M,t as u,x as U,I as z}from"./index-PJsAt-0r.js";import{c as E,L,d as P,A as D,f as x,S as J,T as B}from"./Layout-CnjaXxaQ.js";import{c as H}from"./orders-D0YV4got.js";import{c as X}from"./payments-Qy3kmAHN.js";import{C as Y}from"./chevron-left-Dspxy7co.js";import{M as Q}from"./map-pin-DsEFjIYp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=T("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var $="clover",I="https://js.stripe.com",K="".concat(I,"/").concat($,"/stripe.js"),W=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Z=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var ee=function(t){return W.test(t)||Z.test(t)},se=function(){for(var t=document.querySelectorAll('script[src^="'.concat(I,'"]')),s=0;s<t.length;s++){var a=t[s];if(ee(a.src))return a}return null},k=function(t){var s="",a=document.createElement("script");a.src="".concat(K).concat(s);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(a),a},p=null,j=null,y=null,te=function(t){return function(s){t(new Error("Failed to load Stripe.js",{cause:s}))}},re=function(t,s){return function(){window.Stripe?t(window.Stripe):s(new Error("Stripe.js not available"))}},ae=function(t){return p!==null?p:(p=new Promise(function(s,a){if(typeof window>"u"||typeof document>"u"){s(null);return}if(window.Stripe){s(window.Stripe);return}try{var r=se();if(!(r&&t)){if(!r)r=k(t);else if(r&&y!==null&&j!==null){var f;r.removeEventListener("load",y),r.removeEventListener("error",j),(f=r.parentNode)===null||f===void 0||f.removeChild(r),r=k(t)}}y=re(s,a),j=te(a),r.addEventListener("load",y),r.addEventListener("error",j)}catch(c){a(c);return}}),p.catch(function(s){return p=null,Promise.reject(s)}))},h,ne=function(){return h||(h=ae(null).catch(function(t){return h=null,Promise.reject(t)}),h)};Promise.resolve().then(function(){return ne()}).catch(function(n){console.warn(n)});const ie=()=>(console.error("Stripe publishable key not found"),Promise.resolve(null));async function le(n){const t=await ie();if(!t)throw new Error("Stripe not initialized");const{error:s}=await t.redirectToCheckout({sessionId:n});if(s)throw s}function fe(){const n=A(),{user:t}=O(),{items:s,subtotal:a,isLoading:r,refreshCart:f}=G(),[c,g]=m.useState(!1),[b,ce]=m.useState(!1),[oe,R]=m.useState(null),[o,_]=m.useState({fullName:"",email:(t==null?void 0:t.email)||"",phone:"",address:"",city:"",postalCode:"",country:""});m.useEffect(()=>{if(!r&&s.length===0&&!b){N.error("Your cart is empty"),n("/");return}},[s,r,b,n]);const v=a>41700?0:1e3,w=Math.round(a*.18),S=a+v+w,q=async i=>{if(i.preventDefault(),s.length===0){N.error("Your cart is empty");return}g(!0);try{const{data:{user:l}}=await z.auth.getUser(),C=await H(s);R(C.id);const{sessionId:F}=await X(C.id,S,(l==null?void 0:l.id)??null,"usd");await le(F)}catch(l){console.error("Checkout error:",l),N.error("Failed to process checkout",{description:l.message||"Please try again.",duration:5e3}),g(!1)}},d=i=>{_(l=>({...l,[i.target.name]:i.target.value}))};return r?e.jsx(E,{children:e.jsx("div",{className:"container-main pt-32 pb-24 min-h-screen flex items-center justify-center",children:e.jsx(L,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(E,{children:e.jsxs("div",{className:"container-main pt-24 pb-16 md:pt-32 md:pb-24",children:[e.jsxs(M,{to:"/",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground text-sm mb-10 transition-colors duration-200",children:[e.jsx(Y,{className:"w-4 h-4"}),"Back to Home"]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8 lg:gap-12",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card border border-border rounded-3xl p-8 md:p-10 shadow-[0_0_40px_rgba(139,30,63,0.05)]",children:[e.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-8",children:"Checkout"}),e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-lg mb-4 flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-primary"}),"Shipping Information"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"fullName",className:"block text-sm font-medium mb-2",children:["Full Name ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"text",id:"fullName",name:"fullName",value:o.fullName,onChange:d,required:!0,className:"input-field w-full",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:["Email ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:d,required:!0,className:"input-field w-full",placeholder:"your@email.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium mb-2",children:["Phone ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:o.phone,onChange:d,required:!0,className:"input-field w-full",placeholder:"+1 (555) 123-4567"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"city",className:"block text-sm font-medium mb-2",children:["City ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"text",id:"city",name:"city",value:o.city,onChange:d,required:!0,className:"input-field w-full",placeholder:"New York"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"address",className:"block text-sm font-medium mb-2",children:["Address ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"text",id:"address",name:"address",value:o.address,onChange:d,required:!0,className:"input-field w-full",placeholder:"123 Main Street"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"postalCode",className:"block text-sm font-medium mb-2",children:["Postal Code ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"text",id:"postalCode",name:"postalCode",value:o.postalCode,onChange:d,required:!0,className:"input-field w-full",placeholder:"10001"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"country",className:"block text-sm font-medium mb-2",children:["Country ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{type:"text",id:"country",name:"country",value:o.country,onChange:d,required:!0,className:"input-field w-full",placeholder:"United States"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-lg mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-primary"}),"Payment Method"]}),e.jsx("div",{className:"bg-secondary/50 border border-border rounded-xl p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Secure Payment"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payment processing will be integrated in the next phase."})]})]})})]}),e.jsx(u.button,{type:"submit",disabled:c||s.length===0,className:U("btn-primary w-full py-5 text-base flex items-center justify-center gap-3",(c||s.length===0)&&"opacity-50 cursor-not-allowed"),whileHover:!c&&s.length>0?{scale:1.02}:{},whileTap:!c&&s.length>0?{scale:.98}:{},children:e.jsx(D,{mode:"wait",children:c?e.jsxs(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center gap-3",children:[e.jsx(L,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Processing Order..."})]},"loading"):e.jsxs(u.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Place Order"]},"default")})})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(u.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-card border border-border rounded-3xl p-6 md:p-8 shadow-[0_0_40px_rgba(139,30,63,0.05)] sticky top-32",children:[e.jsx("h3",{className:"font-serif text-xl mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6",children:s.map(i=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-16 h-20 bg-secondary rounded-lg overflow-hidden flex-shrink-0",children:e.jsx("img",{src:i.image,alt:i.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:i.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Size: ",i.size]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Qty: ",i.quantity]}),e.jsx("p",{className:"text-primary font-medium mt-1",children:x(i.price*i.quantity)})]})]},i.id))}),e.jsxs("div",{className:"border-t border-border pt-6 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{children:x(a)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipping"}),e.jsx("span",{children:v===0?e.jsx("span",{className:"text-primary font-medium",children:"Free"}):x(v)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tax"}),e.jsx("span",{children:x(w)})]}),e.jsxs("div",{className:"border-t border-border pt-3 flex justify-between items-baseline",children:[e.jsx("span",{className:"font-medium",children:"Total"}),e.jsx("span",{className:"font-serif text-2xl text-primary",children:x(S)})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-border space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(J,{className:"w-4 h-4 text-primary"}),e.jsx("span",{children:"Secure checkout"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(B,{className:"w-4 h-4 text-primary"}),e.jsx("span",{children:"Free shipping over Rs. 41,700"})]})]})]})})]})]})})}export{fe as default};
