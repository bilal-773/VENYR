import{c as D,B as W,H as A,j as o,G as m,q as e,L,t as c,x as S}from"./index-PJsAt-0r.js";import{c as O,L as _,g as I,T as F,f as x}from"./Layout-CnjaXxaQ.js";import{g as M,a as P}from"./orders-D0YV4got.js";import{C as X}from"./chevron-left-Dspxy7co.js";import{C as G}from"./clock-DtkgdJsO.js";import{E as Q}from"./eye-5_jIhzbT.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=D("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=D("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),p={pending:{label:"Pending Payment",icon:G,color:"text-yellow-600 bg-yellow-100"},paid:{label:"Paid",icon:E,color:"text-green-600 bg-green-100"},processing:{label:"Processing",icon:I,color:"text-blue-600 bg-blue-100"},shipped:{label:"Shipped",icon:F,color:"text-purple-600 bg-purple-100"},delivered:{label:"Delivered",icon:E,color:"text-green-600 bg-green-100"},cancelled:{label:"Cancelled",icon:R,color:"text-red-600 bg-red-100"}};function ee(){const u=W(),{user:l}=A(),[d,h]=o.useState([]),[q,g]=o.useState(!0),[f,y]=o.useState(null),[B,j]=o.useState(new Set);o.useEffect(()=>{if(!l){m.error("Please log in to view orders"),u("/login");return}T()},[l,u]);const T=async()=>{if(l){g(!0);try{const s=await M(l.id),i=await Promise.all(s.map(async t=>{try{const{order:r,items:n}=await P(t.id);return{...t,order_items:n}}catch(r){return console.error(`Error loading items for order ${t.id}:`,r),t}}));h(i)}catch(s){console.error("Error loading orders:",s),m.error("Failed to load orders",{description:s.message||"Please try again."})}finally{g(!1)}}},z=async s=>{if(f===s){y(null);return}y(s);const i=d.find(t=>t.id===s);if(i&&!i.order_items){j(t=>new Set(t).add(s));try{const{items:t}=await P(s);h(r=>r.map(n=>n.id===s?{...n,order_items:t}:n))}catch(t){console.error("Error loading order items:",t),m.error("Failed to load order items",{description:t.message||"Please try again."})}finally{j(t=>{const r=new Set(t);return r.delete(s),r})}}},H=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return q?e.jsx(O,{children:e.jsx("div",{className:"container-main pt-32 pb-24 min-h-screen flex items-center justify-center",children:e.jsx(_,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(O,{children:e.jsxs("div",{className:"container-main pt-24 pb-16 md:pt-32 md:pb-24",children:[e.jsxs("div",{className:"mb-10",children:[e.jsxs(L,{to:"/",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground text-sm mb-6 transition-colors duration-200",children:[e.jsx(X,{className:"w-4 h-4"}),"Back to Home"]}),e.jsx("h1",{className:"font-serif text-4xl md:text-5xl mb-2",children:"My Orders"}),e.jsx("p",{className:"text-muted-foreground",children:"View and track your order history"})]}),d.length===0?e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-20",children:[e.jsx(c.div,{className:"w-20 h-20 rounded-full bg-secondary flex items-center justify-center mx-auto mb-6",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:e.jsx(I,{className:"w-10 h-10 text-primary",strokeWidth:1.5})}),e.jsx("h2",{className:"font-serif text-2xl mb-2",children:"No Orders Yet"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"Start shopping to see your orders here."}),e.jsx(L,{to:"/watches",className:"btn-primary inline-flex items-center gap-2",children:"Start Shopping"})]}):e.jsx("div",{className:"space-y-4",children:d.map((s,i)=>{const t=p[s.status].icon,r=p[s.status].label,n=p[s.status].color,b=f===s.id,U=B.has(s.id);return e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"bg-card border border-border rounded-2xl overflow-hidden hover:shadow-[0_0_40px_rgba(139,30,63,0.1)] transition-all duration-300",children:[e.jsx("div",{className:"p-6 cursor-pointer",onClick:()=>z(s.id),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsxs("h3",{className:"font-serif text-xl",children:["Order #",s.id.slice(0,8).toUpperCase()]}),e.jsxs("span",{className:S("px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1.5",n),children:[e.jsx(t,{className:"w-3 h-3"}),r]})]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Placed on ",H(s.created_at)]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Total"}),e.jsx("p",{className:"font-serif text-2xl text-primary",children:x(s.total)})]}),e.jsx(c.button,{className:S("p-2 rounded-lg border border-border hover:bg-primary/10 transition-colors",b&&"bg-primary/10 border-primary"),whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(Q,{className:"w-5 h-5"})})]})]})}),b&&e.jsx(c.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"border-t border-border",children:U?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(_,{className:"w-6 h-6 animate-spin text-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading items..."})]}):s.order_items&&s.order_items.length>0?e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm uppercase tracking-wider text-muted-foreground",children:"Order Items"}),e.jsx("div",{className:"space-y-4",children:s.order_items.map(a=>{var N,v,w,k,C;return e.jsxs("div",{className:"flex gap-4 p-4 bg-secondary/50 rounded-xl",children:[e.jsx("div",{className:"w-20 h-24 bg-secondary rounded-lg overflow-hidden flex-shrink-0",children:e.jsx("img",{src:((N=a.products)==null?void 0:N.image)||((w=(v=a.products)==null?void 0:v.images)==null?void 0:w[0])||"/placeholder.svg",alt:((k=a.products)==null?void 0:k.name)||"Product",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h5",{className:"font-medium text-sm mb-1",children:((C=a.products)==null?void 0:C.name)||"Product"}),e.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Quantity: ",a.quantity]}),e.jsxs("p",{className:"font-medium text-primary",children:[x(a.price_at_order)," each"]}),e.jsxs("p",{className:"text-sm font-medium mt-2",children:["Subtotal: ",x(a.price_at_order*a.quantity)]})]})]},a.id)})})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No items found"})})})]},s.id)})})]})})}export{ee as default};
