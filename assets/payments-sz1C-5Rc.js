import{I as a}from"./index-BRNuU9-M.js";async function d(o,e,r,s="usd"){const{data:t,error:c}=await a.functions.invoke("create-checkout-session",{body:{orderId:o,amount:Math.round(e*100),currency:s,userId:r,successUrl:`${window.location.origin}/#/payment-success?session_id={CHECKOUT_SESSION_ID}&order_id=${o}`,cancelUrl:`${window.location.origin}/#/checkout?cancelled=true`}});if(c)throw console.error("Error creating checkout session:",c),new Error(c.message||"Failed to create checkout session");return t}async function n(o,e){const{error:r}=await a.from("orders").update({status:"paid"}).eq("id",e);if(r)throw console.error("Error updating order status:",r),r;const{data:s}=await a.from("orders").select("user_id").eq("id",e).single();if(s&&s.user_id){const{error:t}=await a.from("cart_items").delete().eq("user_id",s.user_id);t&&console.error("Error clearing cart:",t)}}async function u(o,e){try{await n(o,e)}catch(r){throw console.error("Error handling payment success:",r),r}}export{d as c,u as h};
